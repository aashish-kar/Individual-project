2025-05-04 21:14:00,524 - root - INFO - Logging initialized. Logs will be written to logs\football_prediction_20250504_211400.log.
2025-05-04 21:14:00,526 - __main__ - INFO - 1. Starting data loading
2025-05-04 21:14:00,538 - src.data.loader - INFO - Loading data from data/raw/FPL_logs.csv
2025-05-04 21:14:00,990 - src.data.loader - INFO - Data validation passed
2025-05-04 21:14:00,991 - src.data.loader - INFO - Dataset loaded: 24573 rows, 80 columns
2025-05-04 21:14:00,991 - src.data.loader - INFO - Columns: ['Date', 'Day', 'Venue', 'Team', 'Opponent', 'Name', 'Start', 'Pos', 'Min', 'Gls']... (and 70 more)
2025-05-04 21:14:00,999 - src.data.loader - INFO - Data types: {dtype('float64'): 59, dtype('O'): 17, dtype('int64'): 3, dtype('bool'): 1}
2025-05-04 21:14:01,043 - src.data.loader - INFO - Missing values: 121533 total missing values
2025-05-04 21:14:01,044 - __main__ - INFO - 2. Starting data preprocessing
2025-05-04 21:14:01,061 - src.data.preprocessor - INFO - Starting data preprocessing
2025-05-04 21:14:01,086 - src.data.preprocessor - INFO - Filtered rows with playing time > 0: 19236 rows remaining
2025-05-04 21:14:01,087 - src.data.preprocessor - INFO - Handling missing values
2025-05-04 21:14:01,293 - src.data.preprocessor - INFO - Missing values handled: 0 remaining
2025-05-04 21:14:01,294 - src.data.preprocessor - INFO - Creating binary target variable with threshold 5.0
2025-05-04 21:14:01,296 - src.data.preprocessor - INFO - Target variable distribution: {0: 15242, 1: 3994}
2025-05-04 21:14:01,296 - src.data.preprocessor - INFO - Dropping 10 non-feature columns
2025-05-04 21:14:01,320 - src.data.preprocessor - INFO - Transforming features
2025-05-04 21:14:01,332 - src.data.preprocessor - INFO - Encoding 10 categorical variables
2025-05-04 21:14:01,779 - src.data.preprocessor - INFO - Feature transformation complete: 78 features
2025-05-04 21:14:01,782 - src.data.preprocessor - INFO - Default temporal split (80/10/10): Train=15388, Val=1923, Test=1925
2025-05-04 21:14:01,782 - src.data.preprocessor - INFO - Data preprocessing completed
2025-05-04 21:14:01,786 - __main__ - INFO - 3. Starting feature selection
2025-05-04 21:14:01,805 - src.features.selector - INFO - Performing SelectKBest feature selection with cross-validation
2025-05-04 21:14:01,805 - src.features.selector - INFO - Selecting top 30 features using univariate tests
2025-05-04 21:14:01,887 - src.features.selector - INFO - Selected 30 features using SelectKBest
2025-05-04 21:14:08,689 - src.features.selector - INFO - Cross-validated F1 score with selected features: 0.9672 ± 0.0046
2025-05-04 21:14:08,695 - __main__ - INFO - Saved selected features to output\selected_features.joblib for prediction UI
2025-05-04 21:14:08,695 - __main__ - INFO - 4. Starting model training and evaluation
2025-05-04 21:14:08,696 - __main__ - INFO - Training and evaluating RandomForest model
2025-05-04 21:14:11,832 - model.{'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 4, 'class_weight': 'balanced', 'random_state': 42} - INFO - Classification report:
              precision    recall  f1-score   support

           0       0.99      0.99      0.99      1506
           1       0.96      0.97      0.97       419

    accuracy                           0.99      1925
   macro avg       0.98      0.98      0.98      1925
weighted avg       0.99      0.99      0.99      1925

2025-05-04 21:14:11,835 - model.{'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 4, 'class_weight': 'balanced', 'random_state': 42} - INFO - Confusion matrix:
[[1490   16]
 [  12  407]]
2025-05-04 21:14:12,026 - __main__ - INFO - Saved RandomForest model to output\randomforest_model.joblib
2025-05-04 21:14:12,027 - __main__ - INFO - RandomForest metrics: {'accuracy': 0.9854545454545455, 'precision': 0.9621749408983451, 'recall': 0.9713603818615751, 'f1_score': 0.9667458432304038, 'roc_auc': np.float64(0.9987535934226499)}
2025-05-04 21:14:12,130 - __main__ - INFO - Saved feature importance to output\randomforest_feature_importance.csv
2025-05-04 21:14:12,130 - __main__ - INFO - Training and evaluating SVM model
2025-05-04 21:14:59,149 - model.{'C': 5.0, 'kernel': 'rbf', 'gamma': 0.01, 'probability': True, 'class_weight': 'balanced', 'random_state': 42} - INFO - Classification report:
              precision    recall  f1-score   support

           0       0.99      0.98      0.98      1506
           1       0.92      0.96      0.94       419

    accuracy                           0.97      1925
   macro avg       0.96      0.97      0.96      1925
weighted avg       0.98      0.97      0.97      1925

2025-05-04 21:14:59,152 - model.{'C': 5.0, 'kernel': 'rbf', 'gamma': 0.01, 'probability': True, 'class_weight': 'balanced', 'random_state': 42} - INFO - Confusion matrix:
[[1473   33]
 [  16  403]]
2025-05-04 21:14:59,157 - __main__ - INFO - Saved SVM model to output\svm_model.joblib
2025-05-04 21:14:59,158 - __main__ - INFO - SVM metrics: {'accuracy': 0.9745454545454545, 'precision': 0.9243119266055045, 'recall': 0.9618138424821002, 'f1_score': 0.9426900584795321, 'roc_auc': np.float64(0.9950318059504226)}
2025-05-04 21:14:59,159 - __main__ - INFO - Training and evaluating NeuralNetwork model
2025-05-04 21:15:29,674 - model.{'hidden_layer_sizes': [64, 32, 16], 'activation': 'relu', 'solver': 'adam', 'alpha': 0.001, 'learning_rate': 0.001, 'max_iter': 300, 'random_state': 42} - INFO - Classification report:
              precision    recall  f1-score   support

           0       0.99      0.98      0.99      1506
           1       0.94      0.97      0.96       419

    accuracy                           0.98      1925
   macro avg       0.97      0.98      0.97      1925
weighted avg       0.98      0.98      0.98      1925

2025-05-04 21:15:29,679 - model.{'hidden_layer_sizes': [64, 32, 16], 'activation': 'relu', 'solver': 'adam', 'alpha': 0.001, 'learning_rate': 0.001, 'max_iter': 300, 'random_state': 42} - INFO - Confusion matrix:
[[1482   24]
 [  14  405]]
2025-05-04 21:15:29,767 - __main__ - INFO - Saved NeuralNetwork model to output\neuralnetwork_model.joblib
2025-05-04 21:15:29,768 - __main__ - INFO - NeuralNetwork metrics: {'accuracy': 0.9802597402597403, 'precision': 0.9440559440559441, 'recall': 0.9665871121718377, 'f1_score': 0.9551886792452831, 'roc_auc': np.float64(0.9974739070765467)}
2025-05-04 21:15:29,769 - __main__ - INFO - Training and evaluating GradientBoosting model
2025-05-04 21:15:31,271 - model.{'n_estimators': 300, 'max_depth': 6, 'learning_rate': 0.05, 'subsample': 0.8, 'colsample_bytree': 0.8, 'random_state': 42} - INFO - Classification report:
              precision    recall  f1-score   support

           0       1.00      0.99      0.99      1506
           1       0.96      0.98      0.97       419

    accuracy                           0.99      1925
   macro avg       0.98      0.99      0.98      1925
weighted avg       0.99      0.99      0.99      1925

2025-05-04 21:15:31,276 - model.{'n_estimators': 300, 'max_depth': 6, 'learning_rate': 0.05, 'subsample': 0.8, 'colsample_bytree': 0.8, 'random_state': 42} - INFO - Confusion matrix:
[[1489   17]
 [   7  412]]
2025-05-04 21:15:31,296 - __main__ - INFO - Saved GradientBoosting model to output\gradientboosting_model.joblib
2025-05-04 21:15:31,297 - __main__ - INFO - GradientBoosting metrics: {'accuracy': 0.9875324675324675, 'precision': 0.9603729603729604, 'recall': 0.9832935560859188, 'f1_score': 0.9716981132075472, 'roc_auc': np.float64(0.9992615060838588)}
2025-05-04 21:15:31,314 - __main__ - INFO - Saved feature importance to output\gradientboosting_feature_importance.csv
2025-05-04 21:15:31,315 - __main__ - INFO - 5. Creating visualizations
2025-05-04 21:15:32,692 - model.{'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 10, 'min_samples_leaf': 4, 'class_weight': 'balanced', 'random_state': 42} - INFO - Model loaded from output\randomforest_model.joblib
2025-05-04 21:15:33,256 - model.{'C': 5.0, 'kernel': 'rbf', 'gamma': 0.01, 'probability': True, 'class_weight': 'balanced', 'random_state': 42} - INFO - Model loaded from output\svm_model.joblib
2025-05-04 21:15:34,877 - model.{'hidden_layer_sizes': [64, 32, 16], 'activation': 'relu', 'solver': 'adam', 'alpha': 0.001, 'learning_rate': 0.001, 'max_iter': 300, 'random_state': 42} - INFO - Model loaded from output\neuralnetwork_model.joblib
2025-05-04 21:15:35,690 - model.{'n_estimators': 300, 'max_depth': 6, 'learning_rate': 0.05, 'subsample': 0.8, 'colsample_bytree': 0.8, 'random_state': 42} - INFO - Model loaded from output\gradientboosting_model.joblib
2025-05-04 21:15:36,114 - __main__ - INFO - Pipeline completed successfully
